<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>InfinityCloud ‚òÅÔ∏è</title>
<style>
body {
  background:#0b1220;color:#fff;font-family:Arial, sans-serif;margin:0;padding:0;text-align:center;
}
.container {
  max-width:600px;margin:60px auto;background:#111a2d;padding:20px;border-radius:16px;box-shadow:0 0 20px #0005;
}
input, textarea, button {
  width:90%;margin:10px 0;padding:10px;border:none;border-radius:8px;
}
textarea {height:150px;}
button {
  cursor:pointer;background:#6ee7b7;color:#000;font-weight:bold;
}
button:hover {opacity:0.8;}
#sitesList a {
  display:block;margin:5px 0;padding:8px;border-radius:8px;background:#1e293b;color:#fff;text-decoration:none;
}
</style>
</head>
<body>
  <div class="container">
    <h1>üåê InfinityCloud</h1>
    <p>Hospede seus sites de forma simples e r√°pida</p>

    <input type="text" id="siteName" placeholder="Nome do site (sem espa√ßos)">
    <textarea id="siteHtml" placeholder="Cole seu c√≥digo HTML aqui"></textarea>
    <button onclick="createSite()">Publicar</button>

    <h2>üåç Comunidade</h2>
    <div id="sitesList"></div>
  </div>

<script>
const userId = localStorage.getItem("userId") || crypto.randomUUID();
localStorage.setItem("userId", userId);

async function loadSites() {
  const res = await fetch("/api/sites");
  const sites = await res.json();
  const list = document.getElementById("sitesList");
  list.innerHTML = "";
  sites.forEach(s => {
    const a = document.createElement("a");
    a.href = "/" + s;
    a.textContent = s;
    list.appendChild(a);
  });
}
loadSites();

async function createSite() {
  const name = document.getElementById("siteName").value.trim();
  const html = document.getElementById("siteHtml").value;
  if (!name) return alert("D√™ um nome para o site!");
  try {
    const res = await fetch("/api/create", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, html, userId })
    });
    const data = await res.json();
    if (!res.ok) throw new Error(data);
    alert(data.message);
    loadSites();
  } catch (err) {
    alert("Erro: " + err.message);
  }
}
</script>
</body>
</html>